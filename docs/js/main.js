(()=>{"use strict";var t={362:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getMovesCount=e.addMove=e.reset=e.resetButtonClick=void 0;const n=o(593),r=o(769),i=[],s=(0,n.getElementById)("movesCounter"),a=(0,n.getButton)("btnUndo"),l=(0,n.getButton)("btnReset"),c=(0,n.getElementById)("movesMade");function d(){r.resetLevel()}function u(){const t=i.length;s.innerText=t.toString(),c.innerHTML=i.map((t=>`<span>${t.robotIndex+1}${t.direction.substr(0,1)}</span>`)).join(""),a.disabled=0===i.length,l.disabled=0===i.length}a.addEventListener("click",(function(){if(1===i.length)return void r.resetLevel();i.pop(),u();const t=i[i.length-1],e=t.robots;r.setGoalVisited(t.goalVisited),r.setRobotsPostitions(e)})),l.addEventListener("click",d),e.resetButtonClick=d,e.reset=function(){i.length=0,u()},e.addMove=function(t,e,o,n){i.push({direction:e,robotIndex:t,robots:o,goalVisited:n}),u()},e.getMovesCount=function(){return i.length}},437:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.activeRobotChanged=e.onColorSelect=e.createButtons=void 0;const n=o(593);let r=[],i=0;const s=(0,n.getElementById)("colorControls");let a;function l(t){i=t,r.forEach(((e,o)=>e.classList.toggle("selected",t===o)))}s.addEventListener("click",(function(t){const e=t.target;if(!e)return;const o=e.dataset.color;o&&(l(parseInt(o)),a(parseInt(o)))})),e.createButtons=function(t){r=new Array(t).fill(null).map(((t,e)=>{const o=document.createElement("button");return o.classList.add("color"+e),e===i&&o.classList.add("selected"),o.dataset.color=e.toString(),o.innerText=(e+1).toString(),o})),s.innerHTML="",r.forEach((t=>s.appendChild(t)))},e.onColorSelect=function(t){a=t},e.activeRobotChanged=function(t){l(t)}},336:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.openModal=void 0,e.openModal=function(t){const e=document.createElement("dialog"),o=document.createElement("button");o.classList.add("button"),o.innerText="OK";const n=document.createElement("div");n.classList.add("dialog-actions"),n.appendChild(o);const r=document.createElement("form");r.method="dialog",r.innerHTML=t,r.appendChild(n),document.body.appendChild(e),e.appendChild(r),e.showModal()}},444:(t,e)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.Direction=void 0,(o=e.Direction||(e.Direction={})).UP="UP",o.LEFT="LEFT",o.RIGHT="RIGHT",o.DOWN="DOWN"},163:(t,e)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.SolverWorkerMessage=void 0,(o=e.SolverWorkerMessage||(e.SolverWorkerMessage={})).PING="PING",o.PONG="PONG",o.SOLVE="SOLVE",o.SOLVE_END="SOLVE_END",o.SOLVE_PROGRESS="SOLVE_PROGRESS"},695:(t,e)=>{var o;Object.defineProperty(e,"__esModule",{value:!0}),e.Wall=void 0,(o=e.Wall||(e.Wall={}))[o.UP=1]="UP",o[o.LEFT=2]="LEFT",o[o.RIGHT=4]="RIGHT",o[o.DOWN=8]="DOWN"},360:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.setGoalVisited=e.onRobotClick=e.setActiveRobot=e.moveRobot=e.setRobotsPositions=e.loadLevel=void 0;const n=o(593),r=o(769),i=o(444),s=o(695),a=(0,n.getElementById)("board");let l,c,d,u,h=null;function g(t){return Promise.all(t.map(((t,e)=>f(e,t.getPos()))))}function f(t,e){return new Promise((o=>{const n=c[t],r=t=>{"transform"===t.propertyName&&(n.removeEventListener("transitionend",r),o())};n.addEventListener("transitionend",r),function(t,e){t.style.transform=`translate(${38*e.x+10}px, ${38*e.y+10}px)`}(n,e)}))}document.addEventListener("touchend",(t=>h=null)),document.addEventListener("touchmove",(function(t){if(null===h)return;const e=t.touches[0].screenX,o=t.touches[0].screenY,n={x:u.x-e,y:u.y-o};Math.abs(n.x)>40&&Math.abs(n.y)<20?(r.moveActiveRobot(n.x>0?i.Direction.LEFT:i.Direction.RIGHT),h=null,u=null):Math.abs(n.y)>40&&Math.abs(n.x)<20&&(r.moveActiveRobot(n.y>0?i.Direction.UP:i.Direction.DOWN),h=null,u=null)}),{passive:!0}),e.loadLevel=function(t){const e=function(t){return"<table class='boardTable'><tr>"+t.board.tiles.map(((e,o)=>e.map(((e,n)=>{let r="";const i=[];return e&s.Wall.UP&&i.push("wall-up"),e&s.Wall.LEFT&&i.push("wall-left"),e&s.Wall.RIGHT&&i.push("wall-right"),e&s.Wall.DOWN&&i.push("wall-down"),t.goal.x===n&&t.goal.y===o&&(r=`<div class="goal goal-${t.goal.robotIdx}"></div>`),t.robots.forEach((t=>{t.x===n&&t.y===o&&(r=`<div class="start start-${t.idx}"></div>`)})),`<td class='${i.join(" ")}'>${r}</td>`})).join(""))).join("</tr><tr>")+"</tr></table>"}(t);a.innerHTML=e,d=a.querySelector(".goal"),c=t.robots.map((t=>{const e=document.createElement("div");return e.classList.add("robot","robot-"+t.idx),e.innerText=(t.idx+1).toString(),e.addEventListener("click",(e=>{return o=t.idx,void(l&&l(o));var o})),e.addEventListener("touchstart",(e=>function(t,e){h=e,u={x:t.touches[0].screenX,y:t.touches[0].screenY},l&&l(e)}(e,t.idx)),{passive:!0}),e})),c.forEach((t=>{a.appendChild(t)})),g(t.robots)},e.setRobotsPositions=g,e.moveRobot=f,e.setActiveRobot=function(t){c.forEach(((e,o)=>{e.classList.toggle("active",o===t)}))},e.onRobotClick=function(t){l=t},e.setGoalVisited=function(t){d.classList.toggle("visited",t)}},769:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.showSolution=e.switchRobot=e.moveRobot=e.moveActiveRobot=e.setRobotPosition=e.setGoalVisited=e.setRobotsPostitions=e.resetLevel=e.startGame=void 0;const n=o(369),r=o(352),i=o(360),s=o(444),a=o(509),l=o(362),c=o(437),d=o(336),u=o(931);let h,g,f=0;const v=[];let b=!1,m=!0,p=!1;function w(){g=(0,n.cloneRobots)(h.robots),y(g),R(0),x(!1),l.reset()}function y(t){t.forEach(((t,e)=>{k(e,t.getPos())}))}function x(t){p=t,i.setGoalVisited(t)}async function k(t,e){g[t].setPos(e),await i.moveRobot(t,e)}async function L(t,e){const o=function(t){switch(t){case s.Direction.UP:return a.goUp;case s.Direction.LEFT:return a.goLeft;case s.Direction.RIGHT:return a.goRight;case s.Direction.DOWN:return a.goDown}}(e),i=g[t],c=g.filter((e=>e.idx!==t)),f=o(h.board,i,c);if(!f)return;await k(t,f.pos),(0,u.vibrateRobotCollision)();const v=function(){const t=g[h.goal.robotIdx];return t.x===h.goal.x&&t.y===h.goal.y}();if(v&&x(!0),l.addMove(t,e,(0,n.cloneRobots)(g),p),v&&!m||m&&p&&function(){const t=g[h.goal.robotIdx],e=h.robots[h.goal.robotIdx];return t.x===e.x&&t.y===e.y}()){const t=function(t){const e=l.getMovesCount();if(!t)return`Grattis, du klarade det på ${e} drag innan solvern hittade en lösning`;if(t&&t.isAborted)return`Solvern gav upp, men du klarade det på ${e} drag!`;if(t&&t.isAllStatesChecked)return"Öööö... du klarade en omöjlig bana?!";const o=function(t,e){return t<e?0:t===e?3:t<=1+Math.floor(1.3*e)?2:1}(e,t.route.length);return`${e} drag. ${["FUUUSK!","Bättre kan du","Bra gjort!","Perfekt!"][o]} <br>${"⭐".repeat(o)}`}((0,r.getResult)());(0,d.openModal)(t)}}function R(t){t<0||t>g.length-1||(f=t,i.setActiveRobot(t),c.activeRobotChanged(t))}function W(){const t=v.shift();t?(b=!0,L(t.robotIndex,t.direction),setTimeout(W,400)):b=!1}e.startGame=function(t,e){m=e,h=t,(0,r.solve)(h,m),c.createButtons(h.robots.length),i.loadLevel(h),w()},e.resetLevel=w,e.setRobotsPostitions=y,e.setGoalVisited=x,e.setRobotPosition=k,e.moveActiveRobot=function(t){!function(t,e){v.push({robotIndex:t,direction:e}),b||W()}(f,t)},e.moveRobot=L,e.switchRobot=R,e.showSolution=function(){const t=(0,r.getResult)();t&&(w(),v.length=0,v.push(...t.route.map((t=>({direction:t.direction,robotIndex:t.robotIdx})))),setTimeout(W,400))}},872:(t,e)=>{let o,n;function r(t,e){if(null==t)throw new Error("Invalid parameters, enter max, or max and min values");if(null==e&&(e=0),t<e)var o=t,n=e;else o=e,n=t;return o+Math.floor(a()*(n+1-o))}function i(t,e){if(null==t)throw new Error("Invalid parameters, enter max, or max and min values");if(null==e&&(e=0),t<e)var o=t,n=e;else o=e,n=t;return o+a()*(n-o)}Object.defineProperty(e,"__esModule",{value:!0}),e.getHash=e.shuffleCopy=e.shuffle=e.getSeed=e.setRandomSeed=e.setSeed=e.randomOne=e.randomItems=e.randomBool=e.randomFloats=e.randomFloat=e.randomInts=e.randomInt=void 0,c(),e.randomInt=r,e.randomInts=function(t,e,o){for(var n=[],i=0;i<t;i++)n.push(r(e,o));return n},e.randomFloat=i,e.randomFloats=function(t,e,o){for(var n=[],r=0;r<t;r++)n.push(i(e,o));return n},e.randomBool=function(t){return void 0===t&&(t=.5),a()<t},e.randomItems=function(t,e,o){if(o){for(var n=[],i=0;i<e;i++)n.push(t[r(0,t.length-1)]);return n}return(t=u(t)).slice(0,e)},e.randomOne=function(t){return t[r(0,t.length-1)]};var s,a=(s=Math.pow(2,32),function(){return n=(1664525*n+1013904223)%s,n/s});function l(t){o=t,n=t}function c(){l(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))}function d(t){var e,o,n;for(n=t.length;n;n-=1)e=Math.floor(a()*n),o=t[n-1],t[n-1]=t[e],t[e]=o;return t}function u(t){return d(t.slice(0))}e.setSeed=l,e.setRandomSeed=c,e.getSeed=function(){return o},e.shuffle=d,e.shuffleCopy=u,e.getHash=function(t){var e,o,n=0;if(0===t.length)return n;for(e=0,o=t.length;e<o;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n}},378:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Board=void 0;const n=o(872),r=o(695);e.Board=class{constructor(t,e){this.h=t,this.w=e,this.tiles=new Array(t).fill(null).map((()=>new Array(e).fill(0))),this.addTopWalls(),this.addBottomWalls(),this.addLeftWalls(),this.addRightWalls()}getTilesString(){return this.tiles.map((t=>t.map((t=>t.toString(16))).join(""))).join("")}setTiles(t){if(t.length!==this.w*this.h)throw Error(`Unable to set tiles. tiles.length was ${t.length}, expected ${this.w*this.h}`);const e=t.split("").map((t=>parseInt(t,16)));this.tiles=new Array(this.h).fill(null).map(((t,o)=>e.slice(o*this.w,o*this.w+this.w)))}addWall(t,e,o){if(t<0||t>=this.w)throw Error(`x must be between 0 and ${this.w-1}, was: ${t}`);if(e<0||e>=this.h)throw Error(`y must be between 0 and ${this.h-1}, was: ${e}`);this.addSingleWall(t,e,o);const n=this.getTileBehindTheWall(t,e,o);if(n){const t=this.getOppositeWall(o);this.addSingleWall(n.x,n.y,t)}}addRandomWalls(t){let e=0,o=0;for(;e<t&&o<1e3;){o++;const t=n.randomOne([r.Wall.UP,r.Wall.RIGHT,r.Wall.LEFT,r.Wall.DOWN]),i=n.randomInt(0,this.w-1),s=n.randomInt(0,this.h-1);this.tiles[s][i]&t||(this.addWall(i,s,t),e++)}}addSingleWall(t,e,o){const n=this.tiles[e][t];this.tiles[e][t]=n|o}getTileBehindTheWall(t,e,o){return o===r.Wall.UP&&e>0?{x:t,y:e-1}:o===r.Wall.LEFT&&t>0?{x:t-1,y:e}:o===r.Wall.RIGHT&&t+1<this.w?{x:t+1,y:e}:o===r.Wall.DOWN&&e+1<this.h?{x:t,y:e+1}:null}getOppositeWall(t){switch(t){case r.Wall.UP:return r.Wall.DOWN;case r.Wall.DOWN:return r.Wall.UP;case r.Wall.RIGHT:return r.Wall.LEFT;case r.Wall.LEFT:return r.Wall.RIGHT;default:throw Error("Invalid wall "+t)}}addTopWalls(){for(let t=0;t<this.w;t++)this.addSingleWall(t,0,r.Wall.UP)}addBottomWalls(){for(let t=0;t<this.w;t++)this.addSingleWall(t,this.h-1,r.Wall.DOWN)}addLeftWalls(){for(let t=0;t<this.h;t++)this.addSingleWall(0,t,r.Wall.LEFT)}addRightWalls(){for(let t=0;t<this.h;t++)this.addSingleWall(this.w-1,t,r.Wall.RIGHT)}}},81:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Goal=void 0,e.Goal=class{constructor(t,e,o){this.x=t,this.y=e,this.robotIdx=o}}},271:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Level=void 0;const n=o(378),r=o(369),i=o(81),s=o(872);e.Level=class{constructor(t){if("string"==typeof t){const e=t,[o,s,a,l,...c]=e.split("|"),d=parseInt(o),u=s.length/d,h=parseInt(a),g=parseInt(l);this.goal=new i.Goal(h%d,Math.floor(h/d),g),this.robots=c.map(Number).map(((t,e)=>new r.Robot(e,t%d,Math.floor(t/d)))),this.board=new n.Board(u,d),this.board.setTiles(s)}else{const{board:e,robots:o,goal:a}=function({width:t,height:e,wallsCount:o,seed:a,robotCount:l}){s.setSeed(a);const c=new n.Board(e,t);c.addRandomWalls(o);const d=[];for(let t=0;t<c.w;t++)for(let e=0;e<c.h;e++)d.push({x:t,y:e});const u=s.shuffle(d),h=new Array(l).fill(null).map(((t,e)=>{const o=u.pop();return new r.Robot(e,o.x,o.y)})),g=u.pop(),f=s.randomOne(h).idx;return{goal:new i.Goal(g.x,g.y,f),robots:h,board:c}}(t);this.board=e,this.robots=o,this.goal=a}}pos2num(t){return t.x+t.y*this.board.w}getLevelString(){const t=this.pos2num(this.goal),e=this.board.getTilesString(),o=this.robots.map((t=>this.pos2num(t))).join("|");return`${this.board.w}|${e}|${t}|${this.goal.robotIdx}|${o}`}}},369:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.cloneRobots=e.Robot=void 0;class o{constructor(t,e,o){this.idx=t,this.x=e,this.y=o}getPos(){return{x:this.x,y:this.y}}setPos(t){this.x=t.x,this.y=t.y}clone(){return new o(this.idx,this.x,this.y)}}e.Robot=o,e.cloneRobots=function(t){return t.map((t=>t.clone()))}},988:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.registerServiceWorker=void 0;let o=!1;const n="serviceWorker"in navigator;function r(t){t.onstatechange=()=>{console.debug("Client: State changed",t.state),"installed"===t.state&&i(t)}}function i(t){console.debug("Client: New worker installed, activate it!"),t.postMessage({action:"skipWaiting"})}function s(t){o||(o=!0,console.debug("Client: New worker active, reload page"),location.reload())}function a(t){console.debug("Client: Message from client:",t.data)}e.registerServiceWorker=async function(){if(!n)return void console.warn("Client: Service worker not available");navigator.serviceWorker.oncontrollerchange=s,navigator.serviceWorker.onmessage=a,console.debug("Client: Register service worker");const t=await navigator.serviceWorker.register("sw.js");console.debug("Client: Service worker registered"),navigator.serviceWorker.controller?t.waiting?i(t.waiting):t.installing?(console.debug("Client: New worker is beeing installed, track it"),r(t.installing)):(console.debug("Client: Listen for new workers"),t.onupdatefound=e=>{console.debug("Client: New worker found, track installation"),r(t.installing)}):console.debug("Client: No active worker found")}},352:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getResult=e.solve=void 0;const n=o(163),r=o(769),i=o(593),s=["röd","grön","blå","gul"];let a,l,c;const d=(0,i.getButton)("btnSolver"),u=(0,i.getElementById)("solverInfo"),h=(0,i.getElementById)("solverDialog"),g=t=>d.children[0].children[0].setAttribute("xlink:href",`icons.svg#icon-${t}`);d.addEventListener("click",(t=>h.showModal()));const f=(0,i.getButton)("btnShowSolution"),v=(0,i.getButton)("btnAbortSolver"),b=(0,i.getButton)("btnCloseSolver");function m(t){switch(t.data.type){case n.SolverWorkerMessage.SOLVE_END:if(l=t.data.result,d.classList.remove("rotate"),v.hidden=!0,l.isRouteFound){g("check");const t=l.robotsUsed.map((t=>s[t])).join(", ");u.innerHTML=`\n          En lösning på ${l.route.length} drag hittades!<br>\n          Använde robotarna: ${t}<br>\n          ${l.statesChecked} states letades igenom på \n          ${l.duration} sekunder\n        `,f.hidden=!1}else l.isAllStatesChecked?(g("impossible"),u.innerHTML=`\n          Ingen lösning kunde hittas. Omöjlig!<br>\n          ${l.statesChecked} states letades igenom på \n          ${l.duration} sekunder\n        `):(g("info"),u.innerHTML=`\n          Orkade inte leta klar.<br>\n          ${l.statesChecked} states letades igenom på \n          ${l.duration} sekunder. Om en lösning finns är den på minst ${l.minMoves}\n        `);break;case n.SolverWorkerMessage.SOLVE_PROGRESS:c=t.data.progress,u.innerHTML=`\n        ${c.checkedStates} states undersökta<br>\n        Letar nu efter lösningar med ${c.currentMovesCount} drag\n      `;break;default:throw Error("Unknown message from web worker: "+t.data.type)}}f.addEventListener("click",(function(){h.close(),r.showSolution()})),v.addEventListener("click",(function(){a.terminate(),v.hidden=!0,u.innerHTML=`\n    Solver aborted. ${c.checkedStates} states undersökta<br>\n    Lösningen har minst ${c.currentMovesCount} drag.\n  `,d.classList.remove("rotate"),g("info")})),b.addEventListener("click",(function(){h.close()})),e.solve=function(t,e=!1){a&&a.terminate(),l=null,g("spinner"),d.classList.add("rotate"),f.hidden=!0,v.removeAttribute("hidden"),a=new Worker("js/solver-worker.js"),a.onmessage=m,a.postMessage({type:n.SolverWorkerMessage.SOLVE,levelString:t.getLevelString(),backAgain:e})},e.getResult=function(){return l}},509:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.hasWall=e.goRight=e.goLeft=e.goDown=e.goUp=void 0;const n=o(444),r=o(695);function i(t,e,o){return 0!=(t.tiles[e.y][e.x]&o)}e.goUp=function(t,e,o){const s={x:e.x,y:e.y};if(i(t,s,r.Wall.UP))return null;const a=Math.max(...o.filter((t=>t.x===s.x&&t.y<s.y)).map((t=>t.y)));for(;s.y>0&&s.y-1!==a&&!i(t,s,r.Wall.UP);s.y--);return s.y===e.y?null:{pos:s,robotIdx:e.idx,dir:n.Direction.UP}},e.goDown=function(t,e,o){const s={x:e.x,y:e.y};if(i(t,s,r.Wall.DOWN))return null;const a=Math.min(...o.filter((t=>t.x===s.x&&t.y>s.y)).map((t=>t.y)));for(;s.y<t.h&&s.y+1!==a&&!i(t,s,r.Wall.DOWN);s.y++);return s.y===e.y?null:{pos:s,robotIdx:e.idx,dir:n.Direction.DOWN}},e.goLeft=function(t,e,o){const s={x:e.x,y:e.y};if(i(t,s,r.Wall.LEFT))return null;const a=Math.max(...o.filter((t=>t.y===s.y&&t.x<s.x)).map((t=>t.x)));for(;s.x>0&&s.x-1!==a&&!i(t,s,r.Wall.LEFT);s.x--);return s.x===e.x?null:{pos:s,robotIdx:e.idx,dir:n.Direction.LEFT}},e.goRight=function(t,e,o){const s={x:e.x,y:e.y};if(i(t,s,r.Wall.RIGHT))return null;const a=Math.min(...o.filter((t=>t.y===s.y&&t.x>s.x)).map((t=>t.x)));for(;s.x<t.w&&s.x+1!==a&&!i(t,s,r.Wall.RIGHT);s.x++);return s.x===e.x?null:{pos:s,robotIdx:e.idx,dir:n.Direction.RIGHT}},e.hasWall=i},593:(t,e)=>{function o(t){const e=document.getElementById(t);if(!e)throw Error("Could not find element "+t);return e}Object.defineProperty(e,"__esModule",{value:!0}),e.getButton=e.getElementById=void 0,e.getElementById=o,e.getButton=function(t){return o(t)}},931:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.vibrateRobotCollision=void 0,e.vibrateRobotCollision=function(){window.navigator.vibrate(10)}}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}(()=>{const t=o(271),e=o(593),n=o(437),r=o(769),i=o(360),s=o(444),a=o(988);let l;document.body.addEventListener("keydown",(function(t){switch(t.key.match(/^\d$/)&&r.switchRobot(parseInt(t.key)-1),t.key){case"F2":d();break;case"Escape":r.resetLevel();break;case"ArrowUp":r.moveActiveRobot(s.Direction.UP);break;case"ArrowLeft":r.moveActiveRobot(s.Direction.LEFT);break;case"ArrowRight":r.moveActiveRobot(s.Direction.RIGHT);break;case"ArrowDown":r.moveActiveRobot(s.Direction.DOWN)}})),(0,e.getButton)("btnNewGame").addEventListener("click",(t=>d()));const c=(0,e.getElementById)("cbxBackAgain");function d(){const t=g(location.search);delete t.seed,h(t)}function u(t){r.switchRobot(t)}function h(e){const o={seed:Math.floor(1e6*Math.random()),backAgain:c.checked,width:10,height:10,wallsCount:20,robotCount:4},n=Object.assign({},o,e),i=function(t){return new URLSearchParams({width:t.width.toString(),height:t.height.toString(),seed:t.seed.toString(),robotCount:t.robotCount.toString(),wallsCount:t.wallsCount.toString(),backAgain:t.backAgain?"true":"false"}).toString()}(n);history.replaceState(null,"title","/?"+i),l=new t.Level(n),r.startGame(l,n.backAgain)}function g(t){const e=new URLSearchParams(t),o={},n=e.get("seed");n&&(o.seed=parseInt(n));const r=e.get("width");r&&(o.width=parseInt(r));const i=e.get("height");i&&(o.height=parseInt(i));const s=e.get("wallsCount");s&&(o.wallsCount=parseInt(s));const a=e.get("robotCount");a&&(o.robotCount=parseInt(a));const l=e.get("backAgain");return l&&(o.backAgain="true"===l),o}c.addEventListener("click",(function(){const t=g(location.search);t.backAgain=!t.backAgain,h(t)})),(0,e.getButton)("btnUp").addEventListener("click",(t=>r.moveActiveRobot(s.Direction.UP))),(0,e.getButton)("btnLeft").addEventListener("click",(t=>r.moveActiveRobot(s.Direction.LEFT))),(0,e.getButton)("btnRight").addEventListener("click",(t=>r.moveActiveRobot(s.Direction.RIGHT))),(0,e.getButton)("btnDown").addEventListener("click",(t=>r.moveActiveRobot(s.Direction.DOWN))),(0,a.registerServiceWorker)(),async function(){const t=g(location.search);h(t),c.checked=t.backAgain,n.onColorSelect((t=>r.switchRobot(t))),i.onRobotClick(u),await navigator.wakeLock.request("screen")}(),window.addEventListener("beforeinstallprompt",(t=>{t.preventDefault();const e=document.getElementById("btnInstall");e.hidden=!1,e.onclick=()=>t.prompt()}))})()})();